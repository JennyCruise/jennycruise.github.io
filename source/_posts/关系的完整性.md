---
title: 关系的完整性
date: 2022-04-20 10:04:43
tags:
- 数据库
categories:
- 数据库原理
- CH2.关系数据库
---

关系的三类完整性约束：
- 实体完整性 & 参照完整性

  > 关系模型必须满足的完整性约束条件，称为`关系的两个不变性`，应该由关系系统自动支持

- 用户定义的完整性

  > 应用领域需要遵循的约束条件，体现了具体领域中的语义约束

<!--more-->

## 实体完整性

- 若属性A是基本关系R的主属性，则属性A不能取空值
- 空值就是“不知道”或“不存在”或“无意义”的值

eg: 

```cpp
选修（学号，课程号，成绩） 
	“学号、课程号”为主码 
	“学号”和“课程号”两个属性都不能取空值
```

实体完整性规则的说明：

1. 实体完整性规则是针对基本关系而言的。
    一个基本表通常对应现实世界的一个实体集。
2. 现实世界中的实体是可区分的，
   即它们具有某种唯 一性标识
3. 关系模型中以主码（候选码）作为唯一性标识。
4. 主码中的属性是主属性（候选码的诸属性）不能取空值

> 主属性取空值，就说明存在某个不可标识的实体，即存在不可区分的实体，
> 这与第（2）点相矛盾，因此这个规则称为实体完整性

## 参照完整性

### 关系间的引用

**在关系模型中实体及实体间的联系都是用关系来 描述的，自然存在着关系与关系间的引用。**

> eg：
>
> 学生（*学号*，姓名，性别，专业号，年龄）
> 专业（*专业号*，专业名）
>
> 学生关系引用了专业关系的主码“专业号”
> 学生关系中的“专业号”值必须是确实存在的专业的专业号

### 外码

- 设F是基本关系R的一个或一组属性，但不是关系R的码。 如果F与基本关系S的主码Ks相对应，则称F是R的外码
- 基本关系R称为参照关系（Referencing Relation）
- 基本关系S称为被参照关系（Referenced Relation） 或目标关系（Target Relation）

> eg
>
>  [例2.1]中学生关系的“专业号”与专业关系的主码“专业号”相对应 
>
> - “专业号”属性是学生关系的外码
> - 专业关系是被参照关系，学生关系为参照关系

- 关系R和S不一定是不同的关系

- 目标关系S的主码Ks和参照关系的外码F必须定义在同一个（或一组）域上

- 外码并不一定要与相应的主码同名

  当外码与相应的主码属于不同关系时，往往取相同的名字，以便于识别

### 参照完整性规则

**规则2.2 参照完整性规则** 

若属性（或属性组）F是基本关系 R 的外码 它与基本关系S 的主码Ks相对应（基本关系R和S不一定是不同的关系）， 则对于R中每个元组在F上的值必须为： 

- 或者取空值（F的每个属性值均为空值）
- 或者等于S中某个元组的主码值

>[例2.1]中
>学生关系中每个元组的“专业号”属性只取两类值：
>
>1. 空值，表示尚未给该学生分配专业 
>2. 非空值，这时该值必须是专业关系中某个元组的“专业号”值，表示该学生不可能分配一个不存在的专业

## 用户定义的完整性

- 针对某一具体关系数据库的约束条件，反映某一具体应用所涉及的数据必须满足的语义要求
- 关系模型应提供定义和检验这类完整性的机制，以便用统一的系统的方法处理它们，而不需由应用程序承担这一功能

> 课程（课程号，课程名，学分）
>
> -  “课程号”属性必须取唯一值
> - 非主属性“课程名”也不能取空值 
> - “学分”属性只能取值{1，2，3，4}
