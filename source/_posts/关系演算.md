---
title: 关系演算
date: 2022-04-20 10:05:13
tags:
- 数据库
categories:
- 数据库原理
- 关系数据库
---
按谓词变元不同进行分类：

1. 元组关系演算： 

   以元组变量作为谓词变元的基本对象 

   元组关系演算语言ALPHA

2. 域关系演算： 

   以域变量作为谓词变元的基本对象 

   域关系演算语言QBE

<!--more-->

## ALPHA语言

### 检索语句

> GET

#### (1) 简单检索

`GET 工作空间名（表达式1）`



> eg.
>
> [例2.14] 查询所有被选修的课程号码
>  	`GET W (SC.Cno)`
>
> [例2.15] 查询所有学生的数据
> 	`GET W (Student)`

#### (2) 限定的检索

`GET 工作空间名（表达式1）：操作条件`

> eg.
>
> [例2.16]查询信息系(IS)中年龄小于20岁的学生的学号和年龄 
> `GET W (Student.Sno，Student.Sage): Student.Sdept='IS'∧ Student.Sage<20`

#### (3) 带排序的检索

`GET 工作空间名（表达式1）[：操作条件] DOWN/UP 表达式2`

> eg.
>
> [例2.17]查询计算机科学系(CS)学生的学号、年龄，结果按年龄降序排序 
> `GET W (Student.Sno，Student.Sage): Student.Sdept='CS' DOWN Student.Sage`

#### (4) 带定额的检索

`GET 工作空间名（定额）（表达式1） [：操作条件] [DOWN/UP 表达式2]`

> eg.
>
> [例2.18] 取出一个信息系学生的学号
> `GET W (1) (Student.Sno): Student.Sdept='IS'`
>
> [例2.19] 查询信息系年龄最大的三个学生的学号及其年龄，结果按年龄降序排序
> `GET W (3) (Student.Sno，Student.Sage): Student.Sdept='IS' DOWN Student.Sage`

(5) 用元组变量的检索

元组变量的用途：

1. 简化关系名：设一个较短名字的元组变量来代替较长的关系名。
2. 操作条件中使用量词时必须用元组变量。

> eg.
>
> [例2.20] 查询信息系学生的名字
> `RANGE Student X 
> GET W (X.Sname): X.Sdept=‘IS'`

(6) 用存在量词的检索

操作条件中使用量词时必须用元组变量

> eg
>
> [例2.21] 查询选修2号课程的学生名字
> `RANGE SC X 
> GET W (Student.Sname): 
> ョX(X.Sno=Student.Sno∧X.Cno='2')`
>
> [例2.22] 查询选修了这样课程的学生学号，其直接先行课是6号课程。
> `RANGE Course CX
> GET W (SC.Sno):
> ョCX (CX.Cno=SC.Cno∧CX.Cpno='6')`
>
> [例2.23]查询至少选修一门其先行课为6号课程的学生名字
>
> `RANGE Course CX 
> 			   SC SCX
> GET W (Student.Sname): ョSCX (SCX.Sno=Student.Sno∧ 
> ョCX (CX.Cno=SCX.Cno∧CX.Pcno='6'))`
> *前束范式形式：* 
> `GET W (Student.Sname): 
> ョSCXョCX (SCX.Sno=Student.Sno∧ CX.Cno=SCX.Cno∧CX.Pcno='6')`

#### (7)带有多个关系的表达式的检索

> eg.
>
> [例2.24] 查询成绩为90分以上的学生名字与课程名字
> `RANGE SC SCX 
> GET W(Student.Sname，Course.Cname): 
> ョSCX (SCX.Grade≥90 
>  ∧SCX.Sno=Student.Sno
> ∧ Course.Cno=SCX.Cno)`
>
> [例2.25] 查询不选1号课程的学生名字 
> `RANGE SC SCX 
> GET W (Student.Sname): 
> ∀SCX ( SCX.Sno≠Student.Sno ∨ SCX.Cno≠'1' )`
> *用存在量词表示：*
> `RANGE SC SCX 
> GET W (Student.Sname):
> ┐∃SCX ( SCX.Sno=Student.Sno ∧ SCX.Cno='1' )`

#### (9)用两种量词的检索

> eg.
>
> 查询选修了全部课程的学生姓名
> `RANGE Course CX 
> 	   SC SCX
> GET W (Student.Sname): 
> ∀CX ∃SCX ( SCX.Sno=Student.Sno ∧ SCX.Cno=CX.Cno )`

(10)用蕴含的检索

> eg.
>
> [例2.27] 查询最少选修了201215122学生所选课程的学生学号
> `RANGE Couse CX 
> SC SCX 
> SC SCY 
> GET W (Student.Sno): ∀ CX ( ∃SCX
> (SCX.Sno=‘201215122'∧SCX.Cno=CX.Cno) 
> → ∃SCY ( SCY.Sno = Student.Sno ∧ SCY.Cno = CX.Cno))`

(11)聚集函数

<img src="image-20220504204756747.png" alt="image-20220504204756747" style="zoom:50%;" />

> eg.
>
> [例2.28] 查询学生所在系的数目
> `GET W ( COUNT(Student.Sdept) ) `
> *COUNT函数在计数时会自动排除重复值。*
>
> [例2.29] 查询信息系学生的平均年龄 
> `GET W (AVG(Student.Sage)): `
> `Student.Sdept='IS'`

### 更新语句

> PUT, HOLD, UPDATE, DELETE, DROP

#### 修改 ( HOLD--修改--UPDATE )

>①用HOLD语句将要修改的元组从数据库中读到工作空间中 
>		HOLD 工作空间名（表达式1）[：操作条件 ] 
>		HOLD 语句是带上并发控制的GET语句
>
>②用宿主语言修改工作空间中元组的属性 
>
>③用UPDATE语句将修改后的元组送回数据库中 
>		UPDATE 工作空间名

eg.

[例2.30] 把201215127学生从计算机科学系转到信息系

```sql
HOLD W (Student.Sno， Student.Sdept): Student.Sno='201215127'
-- 从Student关系中读出201215127学生的数据
MOVE 'IS' TO W.Sdept 
-- 用宿主语言进行修改
UPDATE W 
-- 把修改后的元组送回Student关系）
```

#### 插入 ( 建立新元组--PUT )

> ①用宿主语言在工作空间中建立新元组 
>
> ②用PUT语句把该元组存入指定关系中 
> 		PUT 工作空间名（关系名）
>
> *PUT语句只对一个关系操作，表达式为单个关系名*

eg.

[例2.31] 学校新开设了一门2学分的课程“计算机组织与结构”，其课程号为8，直接先行课为6号课程。插入该课程元组

```sql
MOVE '8' TO W.Cno 
MOVE '计算机组织与结构' TO W.Cname 
MOVE '6' TO W.Cpno 
MOVE '2' TO W.Ccredit 
PUT W (Course)
```



#### 删除 ( HOLD--DELETE )

> ①用HOLD语句把要删除的元组从数据库中读到工作空间中 
>
> ②用DELETE语句删除该元组 
> 		DELETE 工作空间名

eg.

[例2.32] 201215230学生因故退学，删除该学生元组

```sql
HOLD W (Student): Student.Sno=‘201215230' 
DELETE W
```

[例2.33] 将学号201215121改为201215122

```sql
HOLD W (Student): Student.Sno=‘201215121'
DELETE W
MOVE ‘201215122' TO W.Sno 
MOVE '李勇' TO W.Sname 
MOVE '男' TO W.Ssex 
MOVE '20' TO W.Sage 
MOVE 'CS' TO W.Sdept 
PUT W (Student)
```

[例2.34] 删除全部学生

```sql
HOLD W (Student) 
DELETE W
-- 为保证参照完整性，删除Student中元组时相应地要删除SC中的元组 
HOLD W (SC) DELETE W
```

## 

## QBE语言

- 以元组变量的分量即域变量作为谓词变元的基本对象
- QBE：Query By Example
  - 基于屏幕表格的查询语言
  - 查询要求：以填写表格的方式构造查询
  - 用示例元素(域变量)来表示查询结果可能的情况
  - 查询结果：以表格形式显示

具体操作不进行赘述
