---
title: 操作系统-作业四
date: 2022-05-11 21:46:56
tags:
---
两道题，用伪代码完成
<!--more-->

```cpp
/*
桌上有一空盘，只允许存放一个水果。
爸爸专向盘中放橙子，妈妈专向盘中放苹果，
女儿专等吃橙子，儿子专等吃苹果。
规定当盘空时一次只能放一个水果供吃者自用，
请用 PV 操作实现爸爸、妈妈、女儿、儿子四个并发进程的同步。

*/

//设置信号量：
semaphore:
E=1, F1=0, F2=0;
/*
E表示盘中能放入的资源数
F1表示盘中的橙子数
F2表示盘中的苹果数
*/
father()
{
    P(E);	 // 看盘子是否有可用空间
    Put orange;
    V(F1); // 盘中橙子资源量+1
}
mother()
{
    P(E); // 看盘子是否有可用空间
    Put apple;
    V(F2); // 盘中苹果资源量+1
}
daughter()
{
    P(F1); // 看盘中是否有橙子
    take orange;
    V(E); // 盘中可用空间 +1
}
son()
{
    P(F2); // 看盘中是否有苹果
    take apple;
    V(E); // 盘中可用空间 +1
}
```



2.

```cpp
/*
假设有个南北向的桥，仅能容同方向的人顺序走过，
相对方向的两个人则无法通过。现在桥南北端都有过桥人。
现把每个过桥人当成一个进程，用 P , V 操作实现管理。

*/

//设置信号量：
semaphore mutex=1, nmutex=1, smutex=1;
/*
mutex  实现互斥访问
nmutex 表示向北走的资源数
smutex 表示向南走的资源数
*/
int north, south;
North()
{
    P(mutex); // 实现互斥进入
    P(nmutex); //查看是否可以向北走
    If(north == 0) 	P(smutex); // 向南走的资源数-1，阻塞
    north ++;
    V(nmutex);
    V(mutex);

    //过桥
    P(nmutex);
    north --;
    If(north == 0)	V(smutex); // 当桥上没有向北走的人时，释放向南走的资源
    V(nmutex);
}

South()
{
    P(mutex); // 实现互斥进入
    P(smutex); //查看是否可以向南走
    If(south == 0)	P(nmutex); // 向北走的资源数-1，阻塞
    south ++;
    V(smutex);
    V(mutex);

    //过桥
    P(smutex);
    south --;
    If(south == 0)	V(nmutex); //当桥上没有向南走的人时，释放向南走的资源
    V(smutex);
}
```

