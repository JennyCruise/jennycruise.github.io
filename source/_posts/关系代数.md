---
title: 关系代数
date: 2022-04-20 10:04:58
tags:
- 数据库
categories:
- 数据库原理
- CH2.关系数据库
---
- 关系代数是一种抽象的查询语言，它用*对关系的运算*来表达*查询*
- 三要素：
  - 运算对象
  - 运算结果
  - 运算符
- 按运算符分类：
  - 传统的集合运算（水平）
  - 专门的关系运算（行列）

<img src="运算符.png" style="zoom:50%;" />

<!--more-->

## 传统的集合运算

### 并（∪）

- R 和 S

  - 具有相同的目n（即两个关系都有n个属性）
  - 相应的属性取自同一个域

- R ∪ S

  - 仍为n目关系，由 *属于R或属于S* 的元组组成 

    R∪S = { t | t ∈ R ∨ t ∈ S  }

<img src="并.png" style="zoom:50%;" />

### 差（ - ）

- R 和 S

  - 具有相同的目 n
  - 相应的属性取自同一个域

- R - S

  - 仍为n目关系，由 *属于R而不属于S* 的元组组成 

    R - S = { t | t ∈ R  ∧ t ∉ S  }

<img src="差.png" style="zoom:50%;" />

### 交（ ∩ ）

- R 和 S

  - 具有相同的目 n
  - 相应的属性取自同一个域

- R - S

  - 仍为n目关系，由 *既属于R也属于S* 的元组组成 

    R - S = { t | t ∈ R  ∧ t ∉ S  }

<img src="交.png" style="zoom:50%;" />

### 笛卡尔积（ × ）

（广义笛卡尔积）

- R 和 S
  - R: n目关系，k1个元组
  - S: m目关系，k2个元组
- R × S
  - 列：(n+m) 列元组的集合
    - 元组的前n列是关系R的一个元组
    - 后m列是关系S的一个元组
  - 行：k1 × k2个元组

<img src="笛卡尔积.png" style="zoom:50%;" />

## 专门的关系运算

### 先行

1. <img src="先行1.png" style="zoom:67%;" />

2. <img src="先行2.png" style="zoom:63%;" />

3. <img src="先行3.png" style="zoom:68%;" />

4. <img src="先行4.png" style="zoom:60%;" />

<img src="像集.png" style="zoom:50%;" />

### 示例

**学生-课程数据库：**

​	*学生关系 Student、课程关系 Course 和 选修关系 SC*

#### ***Student***

| 学号<br />Sno | 姓名<br />Sname | 性别<br />Ssex | 年龄<br />Sage | 所在系<br />Sdept |
| ------------- | --------------- | -------------- | -------------- | ----------------- |
| 201215121     | 李勇            | 男             | 20             | CS                |
| 201215122     | 刘晨            | 女             | 19             | CS                |
| 201215123     | 王敏            | 女             | 18             | MA                |
| 201215125     | 张立            | 男             | 19             | IS                |

___

#### ***Course***

| 课程号<br />Cno | 课程名<br />Cname | 先行课<br />Cpno | 学分<br />Ccredit |
| --------------- | ----------------- | ---------------- | ----------------- |
| 1               | 数据库            | 5                | 4                 |
| 2               | 数学              |                  | 2                 |
| 3               | 信息系统          | 1                | 4                 |
| 4               | 操作系统          | 6                | 3                 |
| 5               | 数据结构          | 7                | 4                 |
| 6               | 数据处理          |                  | 2                 |
| 7               | Pascal语言        | 6                | 4                 |

___

#### ***SC***

| 学号<br />Sno | 课程号<br />Cno | 成绩<br />Grade92 |
| ------------- | --------------- | ----------------- |
| 201215121     | 1               | 92                |
| 201215121     | 2               | 85                |
| 201215121     | 3               | 88                |
| 201215122     | 2               | 90                |
| 201215122     | 3               | 80                |

___

### 选择 ( σ )

> 选择运算是从关系R中选取使逻辑表达式F为真的元组，是从**行的角度**进行的运算

eg 2.4

<img src="选择1.png" style="zoom:50%;" />

eg 2.5

<img src="选择2.png" style="zoom:50%;" />

### 投影 ( Π )

> 从R中选择出若干属性列组成新的关系，主要是从**列的角度**进行运算
>
> 投影之后不仅取消了原关系中的某些列，而且还可能取消某些元组（避免重复行）

$$
Π_A(R)=\{ t [A] | t ∈ R \}
$$

A: R 中的属性列

eg 2.6

<img src="投影1.png" style="zoom:50%;" />

eg 2.7

<img src="投影2.png" style="zoom:50%;" />



### 连接 ( ⋈ )

> 分为**等值连接**和**自然连接**

eg 2.8 关系R和关系S 如下所示：

<img src="image-20220427215751097.png" alt="image-20220427215751097" style="zoom:50%;" />

一般连接：

<img src="image-20220427215833155.png" alt="image-20220427215833155" style="zoom:50%;" />

等值连接

<img src="image-20220427215856240.png" alt="image-20220427215856240" style="zoom:50%;" />

自然连接

<img src="image-20220427215920881.png" alt="image-20220427215920881" style="zoom:50%;" />



### 除运算 ( ÷ )

同时从行和列角度进行运算

给定关系***R (X，Y)*** 和***S (Y，Z)***，其中X，Y，Z为属性组。
`（ R中的Y与S中的Y可以有不同的属性名，但必须出自相同的域集。）`

 R与S的除运算得到一个新的关系**P(X)**， P是R中满足下列条件的元组在 X属性列上的投影： 

元组在**X**上分量值 **x** 的象集 Yx 包含 S 在 Y 上投影的集合，记作：

$$
R÷S = \{ tr [X] | tr ∈ R ∧ Π_Y(S)⊆Y_x \} 
$$
Yx：x在R中的象集，x = tr[X]

eg 2.9

<img src="image-20220427220546061.png" alt="image-20220427220546061" style="zoom:50%;" />

### 综合举例

书本P56
